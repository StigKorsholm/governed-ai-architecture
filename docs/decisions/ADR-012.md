# ADR-012: Data Classification, Secrets Management, and Audit Integrity

> **Status:** ✅ Accepted  
> **Date:** 2025-12-22  
> **Triggered By:** ADR-000 (security/compliance consequence)  
> **Triggers:** —

---

## Summary

* **Decision:** Enforce explicit data classification rules, implement strict secrets management (never in workflows/logs), and use append-only audit patterns with tamper detection.
* **Chosen approach:** Classification labels, vault-based secrets, hash-chained audit logs.
* **Why:** Compliance reviews require demonstrable controls. Implicit handling is not auditable.
* **Scope:** This ADR covers data handling principles. Specific implementations are operational.

---

## Decision

### Data classification

| Classification | Examples | Handling |
|----------------|----------|----------|
| **Public** | BIAN reference data | No restrictions |
| **Internal** | Table names, mappings | No cloud egress in prod |
| **Confidential** | Business logic, NFRs | Encrypted at rest |
| **Secret** | Connection strings, API keys | Vault only, never logged |

### Secrets management rules

**NEVER** store secrets in:
- ❌ Workflow definitions
- ❌ Log files
- ❌ Git repositories
- ❌ Environment variables in code

**ALWAYS** retrieve secrets from:
- ✅ HashiCorp Vault (or equivalent)
- ✅ Kubernetes secrets
- ✅ Managed secret services

### Audit integrity

Audit records are:
- **Append-only** — No updates or deletes
- **Tamper-evident** — Hash chain linking records
- **Identity-bound** — Reviewer identity from SSO

---

## Consequences

### Positive Consequences

- Easier compliance reviews
- Demonstrable controls
- Tamper detection for audit records

### Negative Consequences

- Requires real operational controls
- Vault integration adds complexity

---

## References

- **Related ADRs:** ADR-002 (audit store), ADR-008 (checkpoints), ADR-011 (local LLM)
