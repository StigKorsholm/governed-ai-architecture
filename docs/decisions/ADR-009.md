# ADR-009: Migration as High-Risk with STOP Conditions

> **Status:** ✅ Accepted  
> **Date:** 2025-12-22  
> **Triggered By:** ADR-008 (consequence: "Some phases require stricter governance")  
> **Triggers:** —

---

## Summary

* **Decision:** Migration planning has higher confidence thresholds, mandatory reconciliation packs, and explicit STOP conditions. Scripts are "execution-ready drafts," not guarantees.
* **Chosen approach:** Higher thresholds, mandatory artifacts, STOP conditions, explicit scope limitation.
* **Why:** Migration errors have irreversible consequences. The cost of a false positive (rejecting valid migration) is much lower than a false negative (accepting invalid migration).
* **Scope:** This ADR covers migration safety posture. Execution in production is explicitly out of scope.

---

## Context

Not all pipeline phases carry equal risk:

| Phase | Risk Level | Consequence of Error |
|-------|------------|---------------------|
| Capability derivation | Low | Rework, delay |
| BIAN mapping | Medium | Incorrect target model |
| **Migration planning** | **High** | **Data loss, corruption, outage** |

The cost asymmetry demands a different posture for migration.

---

## Decision

We will treat **migration as high-risk** with these principles:

### Higher confidence threshold

| Phase | Minimum Confidence |
|-------|-------------------|
| Capability derivation | 0.70 |
| BIAN mapping | 0.75 |
| **Migration planning** | **0.85** |

### Mandatory reconciliation pack

Every migration wave must include:
- `script.sql` — The migration SQL
- `rollback.sql` — Rollback script
- `reconciliation.json` — Expected vs actual checks
- `dependencies.json` — What must complete first
- `evidence.md` — Validation results

**Missing reconciliation pack = STOP**

### STOP conditions

| Condition | Behavior |
|-----------|----------|
| Reconciliation pack incomplete | STOP |
| Dependency order violation | STOP |
| Confidence below 0.85 | STOP (flag for review) |
| Maker-checker disagreement | STOP (escalate) |
| Orphan tables in wave | STOP |

### Explicit scope limitation

MIP produces **execution-ready drafts**, not guarantees.

---

## Consequences

### Positive Consequences

- Strong safety posture
- Clear accountability through maker-checker
- STOP conditions prevent silent failures

### Negative Consequences

- More review overhead
- Some valid migrations may be flagged

---

## References

- **Related ADRs:** ADR-008 (checkpoints), ADR-010 (confidence)
